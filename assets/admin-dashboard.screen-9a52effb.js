import{r as t,j as e}from"./react-bd395152.js";import{F as v}from"./index-84d8b43f.js";import{l as C}from"./lottie-web-22bdd3b9.js";import{d as S}from"./done-7fe8fc93.js";import{U as d}from"./user.context-159b786a.js";import{L as E}from"./react-router-dom-98c6d843.js";import{a as N}from"./react-router-53cec659.js";import"./lodash.throttle-0b3a1717.js";import"./react-dom-8cbe9ec5.js";import"./scheduler-765c72db.js";import"./@fortawesome-0254cf4c.js";import"./prop-types-0f864fce.js";import"./@remix-run-89049d58.js";const y={subject:"",body:"",to:""};function U(u){const{currentUser:s,setCurrentUser:n}=t.useContext(d),[r,i]=t.useState(y),{subject:m,body:p,to:w}=r,x=l=>{const{name:o,value:a}=l.target;i({...r,[o]:a})},[f,h]=t.useState(""),[j,b]=t.useState(!1),[c,g]=t.useState(!1);t.useEffect(()=>{C.loadAnimation({container:document.getElementById("animated"),renderer:"svg",loop:!0,autoplay:!0,animationData:S})},[c]);const B=async l=>{l.preventDefault(),h("");try{b(!0);let o={subject:m,body:p},a;try{console.log(s),a=await fetch("https://localhost:7245/api/Email/Broadcast",{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer "+s}})}catch{if(a==null)throw"Broadcast failed, please contact support center."}if(a.status==200)g(!0);else throw a.status==400?"Broadcast failed, please check your email information":"Broadcast failed, please contact support center."}catch(o){h(o)}finally{setTimeout(function(){g(!1)},5e3),b(!1),i(y)}};return e.jsxs("div",{className:"message-broadcast",children:[c?e.jsx("div",{className:"success-svg",id:"animated"}):e.jsx(e.Fragment,{}),e.jsx("div",{className:"background"}),e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"header",children:e.jsx("h3",{children:"Broadcast Email"})}),e.jsxs("form",{style:c?{visibility:"hidden"}:{},onSubmit:B,children:[f!==""&&e.jsx("div",{className:"error-message",children:e.jsx("p",{className:"error-text",children:f})}),e.jsx(v,{label:"subject",required:!0,type:"text",value:m,name:"subject",onChange:x}),e.jsx(v,{required:!0,type:"textarea",value:p,name:"body",placeholder:"Email body",onChange:x}),e.jsxs("div",{className:"button-container",children:[e.jsx("button",{type:"submit",disabled:j,children:"Broadcast"}),e.jsx("button",{type:"button",disabled:j,children:"Test"})]})]})]})]})}const F="/assets/rise-logo-png-text-8ddf1a20.png";function k(u){const s=N(),{currentUser:n,setCurrentUser:r}=t.useContext(d),i=()=>{r(null),s("/")};return e.jsxs("nav",{className:"admin-navbar",children:[e.jsx("div",{className:"nav-logo",children:e.jsx("img",{src:F,alt:""})}),e.jsx("ul",{children:e.jsx("li",{onClick:i,children:e.jsx(E,{children:"Logout"})})})]})}function P(u){const s=N(),{currentUser:n,setCurrentUser:r}=t.useContext(d);return t.useEffect(()=>{n==null&&s("/admin/login")},[n]),e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx(U,{})]})}export{P as default};
